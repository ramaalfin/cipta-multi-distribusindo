<template>
    <div class="hyper-input" :style="{ maxWidth: extend ? '' : 'max-content' }">
        <input :placeholder="placeholder" :type="type" :disabled="disabled || loading" :value="modelValue" @input="$emit('update:modelValue', $event.target.value)" :class="{ hideText: loading }" v-bind="attributes" />
        <HyLoader v-if="loading" :width="25" :height="25" :line="3" />
    </div>
</template>

<script>
import HyLoader from "./Loader.vue";

export default {
    name: "HyInput",
    props: {
        modelValue: null,
        placeholder: String,
        type: {
            type: String,
            default: "text",
        },
        required: {
            type: Boolean,
            default: false,
        },
        loading: {
            type: Boolean,
            default: false,
        },
        disabled: {
            type: Boolean,
            default: false,
        },
        extend: {
            type: Boolean,
            default: true,
        },
    },
    computed: {
        attributes() {
            let attrs = { ...this.$attrs };

            // Delete attrs that shouldn't appear on the input element
            delete attrs.id;
            delete attrs.class;
            delete attrs.type;
            delete attrs.placeholder;
            delete attrs.loading;
            delete attrs.disabled;
            delete attrs.extend;
            delete attrs.required;

            return attrs;
        },
    },
    components: {
        HyLoader,
    },
};
</script>

<style lang="scss">
.hyper-input {
    margin: var(--element-margin);
    position: relative;
    min-width: max-content;

    input {
        -moz-appearance: none;
        -webkit-appearance: none;
        appearance: none;

        background-color: var(--element-secondary-bg-color);
        border: var(--element-border-secondary);
        border-radius: var(--element-border-radius);
        padding: var(--element-padding);
        font-size: var(--font-size);
        font-family: var(--font-family);
        color: var(--font-color-dark);
        cursor: text;
        outline: none;
        width: 100%;
        transition: var(--element-transition);
        transition-property: background-color, color, border, filter;
        box-shadow: var(--element-shadow);

        &:not([disabled]) {
            &:hover {
                background-color: var(--element-secondary-hover-bg-color);
            }

            &:focus {
                border: var(--element-border-accent);
            }
        }

        &:disabled {
            cursor: not-allowed;
            filter: opacity(50%);
        }

        &.hideText {
            color: transparent;
        }
    }

    .hyper-loader {
        position: absolute;
        top: calc(50% - 12.5px);
        left: calc(50% - 12.5px);
    }
}
</style>
